(()=>{"use strict";class e{name;constructor(e){this.name=e}array(){return new i(this)}}var n;!function(e){e.STRING="string",e.NUMBER="number",e.BOOLEAN="boolean"}(n||(n={}));class t extends e{primitive;constructor(e){super(e),this.primitive=e}extends(e){return e instanceof t&&e.primitive===this.primitive}isAssignable(e){return typeof e===this.primitive}}const r=new t(n.STRING),o=new t(n.NUMBER),a=new t(n.BOOLEAN);class i extends e{elementType;constructor(e){super(e.name+"[]"),this.elementType=e}extends(e){return e instanceof i&&this.elementType.extends(e.elementType)}isAssignable(e){return Array.isArray(e)&&e.every(e=>this.elementType.isAssignable(e))}}const s=r.array(),w=o.array(),h=a.array();function c(e){if(Array.isArray(e)){if(0===e.length)return!0;{const n=typeof e[0];for(let t=0;t<e.length;t++){const r=e[t];if(!c(r)||typeof r!==n)return!1}return!0}}{const n=typeof e;return"string"===n||"number"===n||"boolean"===n}}function l(e){switch(typeof e){case"string":return r;case"number":return o;case"boolean":return a;case"object":if(null!==e&&Array.isArray(e)){if(0===e.length)throw new TypeError("cannot find type of zero-length array");return l(e[0]).array()}default:throw new TypeError(`could not find type of value ${JSON.stringify(e)}`)}}class p{argTypes;returnType;apply;constructor(e,n,t){this.argTypes=e,this.returnType=n,this.apply=t}}class u extends p{constructor(e,n){super([],e,n)}chain(e){return new u(e.returnType,()=>e.apply(this.apply()))}chainLHS(e){return new d(e.rhsType,e.returnType,n=>e.apply(this.apply(),n))}chainRHS(e){return new d(e.lhsType,e.returnType,n=>e.apply(n,this.apply()))}static literal(e){return new u(l(e),()=>e)}}class d extends p{get argType(){return this.argTypes[0]}constructor(e,n,t){super([e],n,t)}chain(e){return new d(this.argType,e.returnType,n=>e.apply(this.apply(n)))}chainLHS(e){return new m(this.argType,e.rhsType,e.returnType,(n,t)=>e.apply(this.apply(n),t))}chainRHS(e){return new m(e.lhsType,this.argType,e.returnType,(n,t)=>e.apply(n,this.apply(t)))}}class m extends p{get lhsType(){return this.argTypes[0]}get rhsType(){return this.argTypes[1]}isCommutative;constructor(e,n,t,r,o=!1){super([e,n],t,r),this.isCommutative=o}chain(e){return new m(this.lhsType,this.rhsType,e.returnType,(n,t)=>e.apply(this.apply(n,t)))}}var y;!function(e){e.pick=function(e){return e[Math.floor(Math.random()*e.length)]}}(y||(y={}));const g=y;class f{name;providers;constructor(e,...n){this.name=e,this.providers=n}findImpl(e){for(const n of this.providers)if(e.extends(n.argType))return n;throw new TypeError(`no ${this.name} implementation found for ${e.name} argument type`)}}class E{name;providers;constructor(e,...n){this.name=e,this.providers=n}findImpl(e,n){for(const t of this.providers)if(e.extends(t.lhsType)&&n.extends(t.rhsType))return t;throw new TypeError(`no ${this.name} implementation found for (${e.name}, ${n.name}) argument types`)}}const b={"random number":new u(o,Math.random),"random boolean":new u(a,()=>Math.random()<=.5),timestamp:new u(o,Date.now)},M={negate:new f("negate",new d(a,a,e=>!e),new d(o,o,e=>-e)),invert:new f("invert",new d(o,o,e=>1/e)),signum:new f("signum",new d(o,o,Math.sign)),length:new f("length",new d(r,o,e=>e.length),new d(s,o,e=>e.length),new d(w,o,e=>e.length),new d(h,o,e=>e.length)),square:new f("square",new d(o,o,e=>e**2)),sqrt:new f("square root",new d(o,o,Math.sqrt)),cube:new f("cube",new d(o,o,e=>e**3)),"cube root":new f("cube root",new d(o,o,Math.cbrt)),exp:new f("exp",new d(o,o,Math.exp)),exp2:new f("exp2",new d(o,o,e=>2**e)),exp10:new f("exp10",new d(o,o,e=>10**e)),ln:new f("ln",new d(o,o,Math.log)),log2:new f("log2",new d(o,o,Math.log2)),log10:new f("log10",new d(o,o,Math.log10)),round:new f("round",new d(o,o,Math.round)),floor:new f("floor",new d(o,o,Math.floor)),ceil:new f("ceil",new d(o,o,Math.ceil)),cos:new f("cos",new d(o,o,Math.cos)),sin:new f("sin",new d(o,o,Math.sin)),tan:new f("tan",new d(o,o,Math.tan)),"deg to rad":new f("deg to rad",new d(o,o,e=>e/360*2*Math.PI)),"rad to deg":new f("rad to deg",new d(o,o,e=>e/2/Math.PI*360)),pick:new f("pick",new d(w,o,g.pick),new d(h,a,g.pick),new d(s,r,g.pick)),lowercase:new f("lowercase",new d(r,r,e=>e.toLocaleLowerCase())),uppercase:new f("uppercase",new d(r,r,e=>e.toLocaleUpperCase())),capitalize:new f("capitalize",new d(r,r,e=>e.charAt(0).toLocaleUpperCase()+e.substring(1))),"capitalize all":new f("capitalize all",new d(r,r,e=>e.split(" ").map(e=>e.charAt(0).toLocaleUpperCase()+e.substring(1)).join(" "))),split:new f("split",new d(r,s,e=>e.split(" "))),join:new f("join",new d(s,r,e=>e.join(" "))),reverse:new f("reverse",new d(r,r,e=>e.split("").reverse().join("")),new d(s,s,e=>e.reverse()),new d(w,w,e=>e.reverse()),new d(h,h,e=>e.reverse())),sort:new f("sort",new d(s,s,e=>e.toSorted()),new d(w,w,e=>e.toSorted((e,n)=>e-n)),new d(h,h,e=>e.toSorted())),shuffle:new f("shuffle",new d(s,s,e=>e.toSorted(()=>Math.random()-.5)),new d(w,w,e=>e.toSorted(()=>Math.random()-.5)),new d(h,h,e=>e.toSorted(()=>Math.random()-.5))),head:new f("head",new d(r,r,e=>e.charAt(0)),new d(s,r,e=>{if(0===e.length)throw new RangeError("empty string array");return e[0]}),new d(w,o,e=>{if(0===e.length)throw new RangeError("empty number array");return e[0]}),new d(h,a,e=>{if(0===e.length)throw new RangeError("empty boolean array");return e[0]})),last:new f("last",new d(r,r,e=>e.charAt(e.length-1)),new d(s,r,e=>{if(0===e.length)throw new RangeError("empty string array");return e[e.length-1]}),new d(w,o,e=>{if(0===e.length)throw new RangeError("empty number array");return e[e.length-1]}),new d(h,a,e=>{if(0===e.length)throw new RangeError("empty boolean array");return e[e.length-1]})),init:new f("init",new d(r,r,e=>e.slice(1)),new d(s,s,e=>e.slice(1)),new d(w,w,e=>e.slice(1)),new d(h,h,e=>e.slice(1))),tail:new f("tail",new d(r,r,e=>e.slice(0,-1)),new d(s,s,e=>e.slice(0,-1)),new d(w,w,e=>e.slice(0,-1)),new d(h,h,e=>e.slice(0,-1))),"to string":new f("to string",new d(r,r,e=>e),new d(o,r,e=>e.toString()),new d(a,r,e=>e.toString()))},T={add:new E("add",new m(r,r,r,(e,n)=>e+n,!0),new m(o,o,o,(e,n)=>e+n,!0),new m(a,a,a,(e,n)=>e||n,!0),new m(a,o,o,(e,n)=>e?0:n,!0),new m(a,r,r,(e,n)=>e?"":n,!0)),sub:new E("sub",new m(o,o,o,(e,n)=>e-n),new m(a,a,a,(e,n)=>e&&!n)),mul:new E("mul",new m(r,o,r,(e,n)=>e.repeat(Math.floor(n))+e.substring(0,Math.round(n%1*e.length)),!0),new m(o,o,o,(e,n)=>e*n,!0),new m(a,a,a,(e,n)=>e&&n,!0),new m(a,o,o,(e,n)=>e?n:0,!0),new m(a,r,r,(e,n)=>e?n:"",!0)),div:new E("div",new m(o,o,o,(e,n)=>e/n),new m(r,o,r,(e,n)=>e.substring(0,Math.round(e.length/n)))),mod:new E("mod",new m(o,o,o,(e,n)=>e%n)),or:new E("or",new m(a,a,a,(e,n)=>e||n,!0),new m(a,o,o,(e,n)=>e?0:n,!0),new m(a,r,r,(e,n)=>e?"":n,!0)),and:new E("and",new m(a,a,a,(e,n)=>e&&n,!0),new m(a,o,o,(e,n)=>e?n:0,!0),new m(a,r,r,(e,n)=>e?n:"",!0)),xor:new E("xor",new m(a,a,a,(e,n)=>e!==n,!0)),nand:new E("nand",new m(a,a,a,(e,n)=>!(e&&n),!0)),nor:new E("nor",new m(a,a,a,(e,n)=>!(e||n),!0)),xnor:new E("xnor",new m(a,a,a,(e,n)=>e===n,!0)),"bitwise or":new E("bitwise or",new m(o,o,o,(e,n)=>e|n,!0)),"bitwise and":new E("bitwise and",new m(o,o,o,(e,n)=>e&n,!0)),"bitwise xor":new E("bitwise xor",new m(o,o,o,(e,n)=>e^n,!0)),join:new E("join",new m(r,r,s,(e,n)=>[e,n]),new m(r,s,s,(e,n)=>[e,...n]),new m(s,r,s,(e,n)=>[...e,n]),new m(s,s,s,(e,n)=>e.concat(n)),new m(o,o,w,(e,n)=>[e,n]),new m(o,w,w,(e,n)=>[e,...n]),new m(w,o,w,(e,n)=>[...e,n]),new m(w,w,w,(e,n)=>e.concat(n)),new m(a,a,h,(e,n)=>[e,n]),new m(a,h,h,(e,n)=>[e,...n]),new m(h,a,h,(e,n)=>[...e,n]),new m(h,h,h,(e,n)=>e.concat(n))),"pick n":new E("pick n",new m(s,o,s,(e,n)=>e.toSorted(()=>Math.random()-.5).slice(0,n)),new m(w,o,w,(e,n)=>e.toSorted(()=>Math.random()-.5).slice(0,n)),new m(h,o,h,(e,n)=>e.toSorted(()=>Math.random()-.5).slice(0,n))),"pick n returned":new E("pick n returned",new m(s,o,s,(e,n)=>{const t=[];for(let r=0;r<n;r++)t.push(e[Math.floor(Math.random()*e.length)]);return t}),new m(w,o,w,(e,n)=>{const t=[];for(let r=0;r<n;r++)t.push(e[Math.floor(Math.random()*e.length)]);return t}),new m(h,o,h,(e,n)=>{const t=[];for(let r=0;r<n;r++)t.push(e[Math.floor(Math.random()*e.length)]);return t}))};function v(e){return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"arg"in e&&x(e.arg)}function S(e){return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"lhs"in e&&x(e.lhs)&&"rhs"in e&&x(e.rhs)}function x(e){return c(e)||function(e){return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name}(e)||v(e)||S(e)}var L;!function(e){let n=!1;window.addEventListener("DOMContentLoaded",()=>n=!0),e.onceDOMContentLoaded=function(){return n?Promise.resolve():new Promise(e=>{window.addEventListener("DOMContentLoaded",()=>e())})};class t extends Error{constructor(e){super(`No element with ID "${e}"`)}}e.NoSuchIdError=t,e.getElementById=function(e,n){const r=document.getElementById(e);if(null===r)throw new t(e);if(!(r instanceof n))throw new TypeError(`Element with ID "${e}" is not a ${n.name}, was "${r.constructor.name}" instead`);return r}}(L||(L={}));const O=L;var A;!function(e){let n;!function(e){e.MOBILE_SLIM="mobile-slim",e.MOBILE="mobile",e.TABLET="tablet",e.DESKTOP="desktop",e.DESKTOP_WIDE="desktop-wide"}(n=e.Viewport||(e.Viewport={}));const t={[n.DESKTOP_WIDE]:{width:16,height:9},[n.DESKTOP]:{width:4,height:3},[n.TABLET]:{width:3,height:4},[n.MOBILE]:{width:9,height:16},[n.MOBILE_SLIM]:{width:9,height:22}},r=new Set;e.onViewportChanged=function(e){r.add(e)},O.onceDOMContentLoaded().then(()=>{window.addEventListener("resize",()=>{const e=Object.values(n).find(e=>{const{width:n,height:r}=t[e];return matchMedia(`(max-aspect-ratio: ${n} / ${r})`).matches})??n.DESKTOP_WIDE;document.body.setAttribute("viewport",e),r.forEach(n=>n(e))}),window.dispatchEvent(new Event("resize"))});const o=new Set;let a;e.onHoverChanged=function(e){o.add(e)},O.onceDOMContentLoaded().then(()=>{const e=matchMedia("(hover: hover)");document.body.toggleAttribute("hover",e.matches),e.addEventListener("change",e=>{document.body.toggleAttribute("hover",e.matches),o.forEach(n=>n(e.matches))})}),function(e){e.NONE="none",e.COARSE="coarse",e.FINE="fine"}(a=e.Pointer||(e.Pointer={}));const i={[a.NONE]:matchMedia("(pointer: none)"),[a.COARSE]:matchMedia("(pointer: coarse)"),[a.FINE]:matchMedia("(pointer: fine)")},s=new Set;e.onPointerChanged=function(e){s.add(e)},O.onceDOMContentLoaded().then(()=>Object.values(a).forEach(e=>{const n=i[e];n.matches&&document.body.setAttribute("pointer",e),n.addEventListener("change",n=>{n.matches&&(document.body.setAttribute("pointer",e),s.forEach(n=>n(e)))})}))}(A||(A={})),console.log("hi");const I=function e(n){if(c(n))return u.literal(n);if(S(n)){const t=T[n.name];if(!t)throw new ReferenceError(`no binary provider with name "${n.name}" exists`);const r=e(n.lhs),o=e(n.rhs),a=t.findImpl(r.returnType,o.returnType);return o.chain(r.chainLHS(a))}if(v(n)){const t=M[n.name];if(!t)throw new ReferenceError(`no unary provider with name "${n.name}" exists`);const r=e(n.arg),o=t.findImpl(r.returnType);return r.chain(o)}{const e=b[n.name];if(!e)throw new ReferenceError(`no nullary provider with name "${n.name}" exists`);return e}}({name:"pick n returned",lhs:"abc".split(""),rhs:5});for(let e=0;e<100;e++)console.log(e+1,I.apply())})();