(()=>{"use strict";var e;!function(e){e.GAME_MODE_SESSION_STORAGE_KEY="gameMode"}(e||(e={}));const t=e;var n;!function(e){e.curry=function(e,t){return(...n)=>t(e,...n)}}(n||(n={}));const r=n;var o;!function(e){e.deepCopy=function e(t){return"object"!=typeof t||null===t?t:Array.isArray(t)?t.map(e):t instanceof Date?new Date(t):Object.fromEntries(Object.entries(t).map(([t,n])=>[t,e(n)]))}}(o||(o={}));const a=o;class i{name;constructor(e){this.name=e}array(){return new p(this)}}var s;!function(e){e.STRING="string",e.NUMBER="number",e.BOOLEAN="boolean"}(s||(s={}));class c extends i{primitive;constructor(e){super(e),this.primitive=e}extends(e){return e instanceof c&&e.primitive===this.primitive}isAssignable(e){return typeof e===this.primitive}}const l=new c(s.STRING),u=new c(s.NUMBER),h=new c(s.BOOLEAN);class p extends i{elementType;constructor(e){super(e.name+"[]"),this.elementType=e}extends(e){return e instanceof p&&this.elementType.extends(e.elementType)}isAssignable(e){return Array.isArray(e)&&e.every(e=>this.elementType.isAssignable(e))}}const d=l.array(),w=u.array(),m=h.array(),f=d.array(),g=w.array(),y=m.array();function E(e){if(Array.isArray(e)){if(0===e.length)return!0;{const t=typeof e[0];for(let n=0;n<e.length;n++){const r=e[n];if(!E(r)||typeof r!==t)return!1}return!0}}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function b(e){switch(typeof e){case"string":return l;case"number":return u;case"boolean":return h;case"object":if(null!==e&&Array.isArray(e)){if(0===e.length)throw new TypeError("cannot find type of zero-length array");return b(e[0]).array()}default:throw new TypeError(`could not find type of value ${JSON.stringify(e)}`)}}class T{variableCollections=[{type:l,vars:{}},{type:u,vars:{}},{type:h,vars:{}},{type:d,vars:{}},{type:w,vars:{}},{type:m,vars:{}}];getVar(e,t,n){for(const r of this.variableCollections)if(r.type.extends(e)&&void 0===(r.vars[t]??n))throw new ReferenceError(`undefined ${e.name} variable "${t}"`);throw new TypeError(`unsupported variable type "${e.name}"`)}setVar(e,t,n){for(const r of this.variableCollections)if(r.type.extends(e))return r.vars[t]=n,this;throw new TypeError(`unsupported variable type "${e.name}"`)}setStringVar=r.curry(l,this.setVar);getStringVar=r.curry(l,this.getVar);setNumberVar=r.curry(u,this.setVar);getNumberVar=r.curry(u,this.getVar);setBooleanVar=r.curry(h,this.setVar);getBooleanVar=r.curry(h,this.getVar);setStringArrayVar=r.curry(d,this.setVar);getStringArrayVar=r.curry(d,this.getVar);setNumberArrayVar=r.curry(w,this.setVar);getNumberArrayVar=r.curry(w,this.getVar);setBooleanArrayVar=r.curry(m,this.setVar);getBooleanArrayVar=r.curry(m,this.getVar);copy(){const e=new T;for(let t=0;t<this.variableCollections.length;t++)e.variableCollections[t].vars=a.deepCopy(this.variableCollections[t].vars);return e}static fromVars(e){const t=new T;for(const n in e){const r=e[n];t.setVar(b(r),n,r)}return t}}class v{argTypes;returnType;apply;constructor(e,t,n){this.argTypes=e,this.returnType=t,this.apply=n}}class x extends v{constructor(e,t){super([],e,t)}chain(e){return new x(e.returnType,t=>e.apply(t,this.apply(t)))}chainLHS(e){return new S(e.rhsType,e.returnType,(t,n)=>e.apply(t,this.apply(t),n))}chainRHS(e){return new S(e.lhsType,e.returnType,(t,n)=>e.apply(t,n,this.apply(t)))}static literal(e){return new x(b(e),()=>e)}}class S extends v{get argType(){return this.argTypes[0]}constructor(e,t,n){super([e],t,n)}chain(e){return new S(this.argType,e.returnType,(t,n)=>e.apply(t,this.apply(t,n)))}chainLHS(e){return new M(this.argType,e.rhsType,e.returnType,(t,n,r)=>e.apply(t,this.apply(t,n),r))}chainRHS(e){return new M(e.lhsType,this.argType,e.returnType,(t,n,r)=>e.apply(t,n,this.apply(t,r)))}}class M extends v{get lhsType(){return this.argTypes[0]}get rhsType(){return this.argTypes[1]}isCommutative;constructor(e,t,n,r,o=!1){super([e,t],n,r),this.isCommutative=o}chain(e){return new M(this.lhsType,this.rhsType,e.returnType,(t,n,r)=>e.apply(t,this.apply(t,n,r)))}}class A extends v{get aType(){return this.argTypes[0]}get bType(){return this.argTypes[1]}get cType(){return this.argTypes[2]}constructor(e,t,n,r,o){super([e,t,n],r,o)}chain(e){return new A(this.aType,this.bType,this.cType,e.returnType,(t,n,r,o)=>e.apply(t,this.apply(t,n,r,o)))}}var L;!function(e){e.pick=function(e){return e[Math.floor(Math.random()*e.length)]}}(L||(L={}));const N=L;class I{name;providers;constructor(e,...t){this.name=e,this.providers=t}findImpl(e){for(const t of this.providers)if(e.extends(t.argType))return t;throw new TypeError(`no ${this.name} implementation found for ${e.name} argument type`)}}class O{name;providers;constructor(e,...t){this.name=e,this.providers=t}findImpl(e,t){for(const n of this.providers){if(e.extends(n.lhsType)&&t.extends(n.rhsType))return n;if(n.isCommutative&&e.extends(n.rhsType)&&t.extends(n.lhsType))return new M(n.rhsType,n.lhsType,n.returnType,(e,t,r)=>n.apply(e,r,t))}throw new TypeError(`no ${this.name} implementation found for (${e.name}, ${t.name}) argument types`)}}const R={"random number":new x(u,Math.random),"random boolean":new x(h,()=>Math.random()<=.5),timestamp:new x(u,Date.now),year:new x(u,()=>(new Date).getFullYear()),month:new x(u,()=>(new Date).getMonth()+1),day:new x(u,()=>(new Date).getDate()),hours:new x(u,()=>(new Date).getHours()),minutes:new x(u,()=>(new Date).getMinutes()),seconds:new x(u,()=>(new Date).getSeconds()),milliseconds:new x(u,()=>(new Date).getMilliseconds())},D={negate:new I("negate",new S(h,h,(e,t)=>!t),new S(u,u,(e,t)=>-t)),invert:new I("invert",new S(u,u,(e,t)=>{if(0===t)throw new RangeError(`cannot take multiplicative inverse of ${t}`);return 1/t})),abs:new I("abs",new S(u,u,(e,t)=>Math.abs(t))),signum:new I("signum",new S(u,u,(e,t)=>Math.sign(t))),length:new I("length",new S(l,u,(e,t)=>t.length),new S(d,u,(e,t)=>t.length),new S(w,u,(e,t)=>t.length),new S(m,u,(e,t)=>t.length)),square:new I("square",new S(u,u,(e,t)=>t**2)),sqrt:new I("square root",new S(u,u,(e,t)=>{if(t<0)throw new RangeError(`cannot take square root of ${t}`);return Math.sqrt(t)})),cube:new I("cube",new S(u,u,(e,t)=>t**3)),"cube root":new I("cube root",new S(u,u,(e,t)=>{if(t<0)throw new RangeError(`cannot take cube root of ${t}`);return Math.cbrt(t)})),exp:new I("exp",new S(u,u,(e,t)=>Math.exp(t))),exp2:new I("exp2",new S(u,u,(e,t)=>2**t)),exp10:new I("exp10",new S(u,u,(e,t)=>10**t)),log:new I("log",new S(u,u,(e,t)=>{if(t<=0)throw new RangeError(`cannot take log of ${t}`);return Math.log(t)})),log2:new I("log2",new S(u,u,(e,t)=>{if(t<=0)throw new RangeError(`cannot take log2 of ${t}`);return Math.log2(t)})),log10:new I("log10",new S(u,u,(e,t)=>{if(t<=0)throw new RangeError(`cannot take log10 of ${t}`);return Math.log10(t)})),round:new I("round",new S(u,u,(e,t)=>Math.round(t))),floor:new I("floor",new S(u,u,(e,t)=>Math.floor(t))),ceil:new I("ceil",new S(u,u,(e,t)=>Math.ceil(t))),cos:new I("cos",new S(u,u,(e,t)=>Math.cos(t))),sin:new I("sin",new S(u,u,(e,t)=>Math.sin(t))),tan:new I("tan",new S(u,u,(e,t)=>Math.tan(t))),"deg to rad":new I("deg to rad",new S(u,u,(e,t)=>t/360*2*Math.PI)),"rad to deg":new I("rad to deg",new S(u,u,(e,t)=>t/2/Math.PI*360)),pick:new I("pick",new S(d,l,(e,t)=>N.pick(t)),new S(m,h,(e,t)=>N.pick(t)),new S(w,u,(e,t)=>N.pick(t))),shuffle:new I("shuffle",new S(d,d,(e,t)=>t.toSorted(()=>Math.random()-.5)),new S(w,w,(e,t)=>t.toSorted(()=>Math.random()-.5)),new S(m,m,(e,t)=>t.toSorted(()=>Math.random()-.5))),lowercase:new I("lowercase",new S(l,l,(e,t)=>t.toLocaleLowerCase())),uppercase:new I("uppercase",new S(l,l,(e,t)=>t.toLocaleUpperCase())),capitalize:new I("capitalize",new S(l,l,(e,t)=>t.charAt(0).toLocaleUpperCase()+t.substring(1))),"capitalize all":new I("capitalize all",new S(l,l,(e,t)=>t.split(" ").map(e=>e.charAt(0).toLocaleUpperCase()+e.substring(1)).join(" "))),split:new I("split",new S(l,d,(e,t)=>t.split(" "))),join:new I("join",new S(d,l,(e,t)=>t.join(" "))),reverse:new I("reverse",new S(l,l,(e,t)=>t.split("").reverse().join("")),new S(d,d,(e,t)=>t.reverse()),new S(w,w,(e,t)=>t.reverse()),new S(m,m,(e,t)=>t.reverse())),array:new I("array",new S(l,d,(e,t)=>[t]),new S(u,w,(e,t)=>[t]),new S(h,m,(e,t)=>[t])),sort:new I("sort",new S(d,d,(e,t)=>t.toSorted()),new S(w,w,(e,t)=>t.toSorted((e,t)=>e-t)),new S(m,m,(e,t)=>t.toSorted())),head:new I("head",new S(l,l,(e,t)=>t.charAt(0)),new S(d,l,(e,t)=>{if(0===t.length)throw new RangeError("empty string array");return t[0]}),new S(w,u,(e,t)=>{if(0===t.length)throw new RangeError("empty number array");return t[0]}),new S(m,h,(e,t)=>{if(0===t.length)throw new RangeError("empty boolean array");return t[0]})),last:new I("last",new S(l,l,(e,t)=>t.charAt(t.length-1)),new S(d,l,(e,t)=>{if(0===t.length)throw new RangeError("empty string array");return t[t.length-1]}),new S(w,u,(e,t)=>{if(0===t.length)throw new RangeError("empty number array");return t[t.length-1]}),new S(m,h,(e,t)=>{if(0===t.length)throw new RangeError("empty boolean array");return t[t.length-1]})),init:new I("init",new S(l,l,(e,t)=>t.slice(1)),new S(d,d,(e,t)=>t.slice(1)),new S(w,w,(e,t)=>t.slice(1)),new S(m,m,(e,t)=>t.slice(1))),tail:new I("tail",new S(l,l,(e,t)=>t.slice(0,-1)),new S(d,d,(e,t)=>t.slice(0,-1)),new S(w,w,(e,t)=>t.slice(0,-1)),new S(m,m,(e,t)=>t.slice(0,-1))),"to string":new I("to string",new S(l,l,(e,t)=>t),new S(u,l,(e,t)=>t.toString()),new S(h,l,(e,t)=>t.toString())),"to number":new I("to number",new S(l,u,(e,t)=>{const n=Number(t);if(isNaN(n))throw new SyntaxError(`invalid number format ${JSON.stringify(t)}`);return n}),new S(u,u,(e,t)=>t),new S(h,u,(e,t)=>t?1:0)),"to boolean":new I("to boolean",new S(l,h,(e,t)=>!!t),new S(u,h,(e,t)=>!!t),new S(h,h,(e,t)=>t)),"string variable":new I("string variable",new S(l,l,(e,t)=>{const n=e.getStringVar(t);if(void 0===n)throw new ReferenceError(`no string variable named ${JSON.stringify(t)}`);return n})),"number variable":new I("number variable",new S(l,u,(e,t)=>{const n=e.getNumberVar(t);if(void 0===n)throw new ReferenceError(`no number variable named ${JSON.stringify(t)}`);return n})),"boolean variable":new I("boolean variable",new S(l,h,(e,t)=>{const n=e.getBooleanVar(t);if(void 0===n)throw new ReferenceError(`no boolean variable named ${JSON.stringify(t)}`);return n})),"string array variable":new I("string variable",new S(l,d,(e,t)=>{const n=e.getStringArrayVar(t);if(void 0===n)throw new ReferenceError(`no string array variable named ${JSON.stringify(t)}`);return n})),"number array variable":new I("number variable",new S(l,w,(e,t)=>{const n=e.getNumberArrayVar(t);if(void 0===n)throw new ReferenceError(`no number array variable named ${JSON.stringify(t)}`);return n})),"boolean array variable":new I("boolean variable",new S(l,m,(e,t)=>{const n=e.getBooleanArrayVar(t);if(void 0===n)throw new ReferenceError(`no boolean array variable named ${JSON.stringify(t)}`);return n}))},C={add:new O("add",new M(l,l,l,(e,t,n)=>t+n,!1),new M(u,u,u,(e,t,n)=>t+n,!0),new M(h,h,h,(e,t,n)=>t||n,!0),new M(h,u,u,(e,t,n)=>t?0:n,!0),new M(h,l,l,(e,t,n)=>t?"":n,!0)),sub:new O("sub",new M(u,u,u,(e,t,n)=>t-n),new M(h,h,h,(e,t,n)=>t&&!n)),mul:new O("mul",new M(u,u,u,(e,t,n)=>t*n,!0),new M(h,h,h,(e,t,n)=>t&&n,!0),new M(h,u,u,(e,t,n)=>t?n:0,!0),new M(h,l,l,(e,t,n)=>t?n:"",!0),new M(l,u,l,(e,t,n)=>t.repeat(Math.floor(n))+t.substring(0,Math.round(n%1*t.length)),!0)),div:new O("div",new M(u,u,u,(e,t,n)=>t/n),new M(l,u,l,(e,t,n)=>t.substring(0,Math.round(t.length/n)))),mod:new O("mod",new M(u,u,u,(e,t,n)=>t%n)),or:new O("or",new M(h,h,h,(e,t,n)=>t||n,!0),new M(h,u,u,(e,t,n)=>t?0:n,!0),new M(h,l,l,(e,t,n)=>t?"":n,!0)),and:new O("and",new M(h,h,h,(e,t,n)=>t&&n,!0),new M(h,u,u,(e,t,n)=>t?n:0,!0),new M(h,l,l,(e,t,n)=>t?n:"",!0)),xor:new O("xor",new M(h,h,h,(e,t,n)=>t!==n,!0)),nand:new O("nand",new M(h,h,h,(e,t,n)=>!(t&&n),!0)),nor:new O("nor",new M(h,h,h,(e,t,n)=>!(t||n),!0)),xnor:new O("xnor",new M(h,h,h,(e,t,n)=>t===n,!0)),"bitwise or":new O("bitwise or",new M(u,u,u,(e,t,n)=>t|n,!0)),"bitwise and":new O("bitwise and",new M(u,u,u,(e,t,n)=>t&n,!0)),"bitwise xor":new O("bitwise xor",new M(u,u,u,(e,t,n)=>t^n,!0)),"less than or equal":new O("less than or equal",new M(u,u,h,(e,t,n)=>t<=n),new M(l,l,h,(e,t,n)=>t.localeCompare(n)<=0)),"less than":new O("less than",new M(u,u,h,(e,t,n)=>t<n),new M(l,l,h,(e,t,n)=>t.localeCompare(n)<0)),equals:new O("equals",new M(u,u,h,(e,t,n)=>t===n,!0),new M(l,l,h,(e,t,n)=>0===t.localeCompare(n),!0),new M(h,h,h,(e,t,n)=>t===n,!0)),"not equals":new O("not equals",new M(u,u,h,(e,t,n)=>t!==n,!0),new M(l,l,h,(e,t,n)=>0!==t.localeCompare(n),!0),new M(h,h,h,(e,t,n)=>t!==n,!0)),"greater than":new O("greater than",new M(u,u,h,(e,t,n)=>t>n),new M(l,l,h,(e,t,n)=>t.localeCompare(n)>0)),"greater than or equal":new O("greater than or equal",new M(u,u,h,(e,t,n)=>t>=n),new M(l,l,h,(e,t,n)=>t.localeCompare(n)>=0)),index:new O("index",new M(d,u,l,(e,t,n)=>{if(n%1!=0)throw new Error(`RHS ${n} is not an integer`);if(n<0||n>=t.length)throw new RangeError(`index ${n} is out of range for array of length ${t.length}`);return t[n]}),new M(w,u,u,(e,t,n)=>{if(n%1!=0)throw new Error(`RHS ${n} is not an integer`);if(n<0||n>=t.length)throw new RangeError(`index ${n} is out of range for array of length ${t.length}`);return t[n]}),new M(m,u,h,(e,t,n)=>{if(n%1!=0)throw new Error(`RHS ${n} is not an integer`);if(n<0||n>=t.length)throw new RangeError(`index ${n} is out of range for array of length ${t.length}`);return t[n]})),join:new O("join",new M(l,l,d,(e,t,n)=>[t,n]),new M(l,d,d,(e,t,n)=>[t,...n]),new M(d,l,d,(e,t,n)=>[...t,n]),new M(d,d,d,(e,t,n)=>t.concat(n)),new M(u,u,w,(e,t,n)=>[t,n]),new M(u,w,w,(e,t,n)=>[t,...n]),new M(w,u,w,(e,t,n)=>[...t,n]),new M(w,w,w,(e,t,n)=>t.concat(n)),new M(h,h,m,(e,t,n)=>[t,n]),new M(h,m,m,(e,t,n)=>[t,...n]),new M(m,h,m,(e,t,n)=>[...t,n]),new M(m,m,m,(e,t,n)=>t.concat(n))),"pick n":new O("pick n",new M(d,u,d,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");return t.toSorted(()=>Math.random()-.5).slice(0,n)}),new M(w,u,w,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");return t.toSorted(()=>Math.random()-.5).slice(0,n)}),new M(m,u,m,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");return t.toSorted(()=>Math.random()-.5).slice(0,n)}),new M(f,u,f,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");return t.toSorted(()=>Math.random()-.5).slice(0,n)}),new M(g,u,g,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");return t.toSorted(()=>Math.random()-.5).slice(0,n)}),new M(y,u,y,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");return t.toSorted(()=>Math.random()-.5).slice(0,n)})),"pick n returned":new O("pick n returned",new M(d,u,d,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");const r=[];for(let e=0;e<n;e++)r.push(t[Math.floor(Math.random()*t.length)]);return r}),new M(w,u,w,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");const r=[];for(let e=0;e<n;e++)r.push(t[Math.floor(Math.random()*t.length)]);return r}),new M(m,u,m,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");const r=[];for(let e=0;e<n;e++)r.push(t[Math.floor(Math.random()*t.length)]);return r}),new M(f,u,f,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");const r=[];for(let e=0;e<n;e++)r.push(t[Math.floor(Math.random()*t.length)]);return r}),new M(g,u,g,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");const r=[];for(let e=0;e<n;e++)r.push(t[Math.floor(Math.random()*t.length)]);return r}),new M(y,u,y,(e,t,n)=>{if(0===t.length)throw new Error("cannot pick from empty array");const r=[];for(let e=0;e<n;e++)r.push(t[Math.floor(Math.random()*t.length)]);return r}))},$={conditional:new class{name;providers;constructor(e,...t){this.name=e,this.providers=t}findImpl(e,t,n){for(const r of this.providers)if(e.extends(r.aType)&&t.extends(r.bType)&&n.extends(r.cType))return r;throw new TypeError(`no ${this.name} implementation found for (${e.name}, ${t.name}, ${n.name}) argument types`)}}("conditional",new A(h,l,l,l,(e,t,n,r)=>t?n:r),new A(h,u,u,u,(e,t,n,r)=>t?n:r),new A(h,h,h,h,(e,t,n,r)=>t?n:r),new A(h,d,d,d,(e,t,n,r)=>t?n:r),new A(h,w,w,w,(e,t,n,r)=>t?n:r),new A(h,m,m,m,(e,t,n,r)=>t?n:r))};function V(e){return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"arg"in e&&P(e.arg)}function k(e){return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"lhs"in e&&P(e.lhs)&&"rhs"in e&&P(e.rhs)}function H(e){return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"a"in e&&P(e.a)&&"b"in e&&P(e.b)&&"c"in e&&P(e.c)}function P(e){return E(e)||function(e){return"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name}(e)||V(e)||k(e)||H(e)}function j(e,t){if(E(e))return x.literal(e);if(H(e)){const n=$[e.name];if(!n)throw new ReferenceError(`no ternary provider with name "${e.name}" exists`);const r=j(e.a),o=j(e.b),a=j(e.c),i=n.findImpl(r.returnType,o.returnType,a.returnType);if(t&&!i.returnType.extends(t))throw new TypeError(`invalid return type: expected ${t.name}, got ${i.returnType.name}`);return new x(i.returnType,e=>i.apply(e,r.apply(e),o.apply(e),a.apply(e)))}if(k(e)){const n=C[e.name];if(!n)throw new ReferenceError(`no binary provider with name "${e.name}" exists`);const r=j(e.lhs),o=j(e.rhs),a=n.findImpl(r.returnType,o.returnType);if(t&&!a.returnType.extends(t))throw new TypeError(`invalid return type: expected ${t.name}, got ${a.returnType.name}`);return o.chain(r.chainLHS(a))}if(V(e)){const n=D[e.name];if(!n)throw new ReferenceError(`no unary provider with name "${e.name}" exists`);const r=j(e.arg),o=n.findImpl(r.returnType);if(t&&!o.returnType.extends(t))throw new TypeError(`invalid return type: expected ${t.name}, got ${o.returnType.name}`);return r.chain(o)}{const n=R[e.name];if(!n)throw new ReferenceError(`no nullary provider with name "${e.name}" exists`);if(t&&!n.returnType.extends(t))throw new TypeError(`invalid return type: expected ${t.name}, got ${n.returnType.name}`);return n}}var _,G;!function(e){e.is=function(e){return"object"==typeof e&&null!==e&&"version"in e&&1===e.version&&"name"in e&&"string"==typeof e.name&&"description"in e&&"string"==typeof e.description&&(!("performanceMetric"in e)||P(e.performanceMetric))}}(_||(_={})),function(e){e.is=function(e){return _.is(e)},e.upgradeToLatest=function(e){if(1===e.version)return e}}(G||(G={}));const B=G;var U;!function(e){let t=!1;window.addEventListener("DOMContentLoaded",()=>t=!0),e.onceDOMContentLoaded=function(){return t?Promise.resolve():new Promise(e=>{window.addEventListener("DOMContentLoaded",()=>e(),{once:!0})})};class n extends Error{constructor(e){super(`No element with ID "${e}"`)}}e.NoSuchIdError=n,e.getElementById=function(e,t){const r=document.getElementById(e);if(null===r)throw new n(e);if(!(r instanceof t))throw new TypeError(`Element with ID "${e}" is not a ${t.name}, was "${r.constructor.name}" instead`);return r}}(U||(U={}));const K=U;var W;!function(e){e.replaceWith=function(e,t){const n=document.querySelector(`placeholder#${e}`);if(!n)throw new ReferenceError(`no placeholder element with id "${e}"`);return n.replaceWith(...[t].flat()),t}}(W||(W={}));const F=W;var q;!function(e){class t{static DESKTOP_WIDE=new t("desktop-wide",16,9);static DESKTOP=new t("desktop",4,3);static TABLET=new t("tablet",3,4);static MOBILE=new t("mobile",9,16);static MOBILE_SLIM=new t("mobile-slim",9,22);static ALL=Object.freeze([this.DESKTOP_WIDE,this.DESKTOP,this.TABLET,this.MOBILE,this.MOBILE_SLIM]);name;width;height;get ratio(){return this.width/this.height}mediaQuery;constructor(e,t,n){this.name=e,this.width=t,this.height=n,this.mediaQuery=matchMedia(`(min-aspect-ratio: ${t} / ${n})`)}[Symbol.toPrimitive](e){return"number"===e?this.ratio:this.name}}let n;e.Viewport=t,e.getViewport=function(){return n};const r=new Set;e.onViewportChanged=function(e){r.add(e)},K.onceDOMContentLoaded().then(()=>{window.addEventListener("resize",()=>{const e=t.ALL.find(e=>e.mediaQuery.matches)??t.MOBILE_SLIM;e!==n&&(n=e,document.body.setAttribute("viewport",n.name),r.forEach(e=>e(n)))}),window.dispatchEvent(new Event("resize"))});class o{static TINY=new o("tiny",300);static SMALL=new o("small",400);static MEDIUM=new o("medium",600);static BIG=new o("big",1e3);static ALL=Object.freeze([this.BIG,this.MEDIUM,this.SMALL,this.TINY]);name;size;mediaQuery;constructor(e,t){this.name=e,this.size=t,this.mediaQuery=matchMedia(`(min-width: ${t}px) and (min-height: ${t/16*9}px)`)}[Symbol.toPrimitive](e){return"number"===e?this.size:this.name}}let a;e.Resolution=o,e.getResolution=function(){return a};const i=new Set;e.onResolutionChanged=function(e){i.add(e)},K.onceDOMContentLoaded().then(()=>{window.addEventListener("resize",()=>{const e=o.ALL.find(e=>e.mediaQuery.matches)??o.TINY;e!==a&&(a=e,document.body.setAttribute("resolution",a.name),i.forEach(e=>e(a)))}),window.dispatchEvent(new Event("resize"))});const s=matchMedia("(hover: hover)");e.canHover=function(){return s.matches};const c=new Set;let l;e.onHoverChanged=function(e){c.add(e)},K.onceDOMContentLoaded().then(()=>{document.body.toggleAttribute("hover",s.matches),s.addEventListener("change",e=>{document.body.toggleAttribute("can-hover",e.matches),c.forEach(t=>t(e.matches))})}),function(e){e.NONE="none",e.COARSE="coarse",e.FINE="fine"}(l=e.PointerAccuracy||(e.PointerAccuracy={}));const u={[l.NONE]:matchMedia("(pointer: none)"),[l.COARSE]:matchMedia("(pointer: coarse)"),[l.FINE]:matchMedia("(pointer: fine)")};e.getPointerAccuracy=function(){return Object.values(l).find(e=>u[e].matches)??l.NONE};const h=new Set;e.onPointerChanged=function(e){h.add(e)},K.onceDOMContentLoaded().then(()=>Object.values(l).forEach(e=>{const t=u[e];t.matches&&document.body.setAttribute("pointer",e),t.addEventListener("change",t=>{t.matches&&(document.body.setAttribute("pointer",e),h.forEach(t=>t(e)))})}))}(q||(q={}));const z=q;class J{locale;translations={};constructor(e){this.locale=new Intl.Locale(e)}register(e){return this.translations={...this.translations,...e},this}lookup(e){return this.translations[e]}}class Q{dict;items=new WeakMap;phraseApplicators=new Set;constructor(e){this.dict=e}setDictionary(e){if(e!==this.dict){this.dict=e;for(const e of this.phraseApplicators){const t=this.items.get(e);if(void 0===t)this.phraseApplicators.delete(e);else{const{dictKey:n,ctx:r}=e.phrase,o=this.dict.lookup(n),a=String(o?.apply(r)??n);e.applicator(t,a)}}}}register(e,t,n,r){const o={phrase:{dictKey:e,ctx:t},applicator:r};this.phraseApplicators.add(o),this.items.set(o,n);const a=this.dict.lookup(e);r(n,String(a?.apply(t)??e))}registerTextContent(e,t,n){return this.register(e,t,n,(e,t)=>e.textContent=t)}registerTitle(e,t,n){return this.register(e,t,n,(e,t)=>e.title=t)}}var Y;!function(e){e.ENGLISH="en-US",e.DUTCH="nl-NL"}(Y||(Y={}));const X=[Y.ENGLISH,Y.DUTCH],Z=Y.ENGLISH;function ee(e){return Object.values(Y).some(t=>e===t)}!function(e){const t="language";function n(){const e=localStorage.getItem(t);return ee(e)?e:Z}function r(n){localStorage.setItem(t,n),K.onceDOMContentLoaded().then(()=>{document.body.setAttribute("language",n)}),e.DICTS_PROMISE.then(e=>e[n]).then(t=>e.MANAGER_PROMISE.then(e=>e.setDictionary(t)))}e.DICTS_PROMISE=Promise.all(X.map(e=>{return(t=(t=e).toString()).startsWith("lang")||(t="lang/"+t),t.endsWith(".json")||(t+=".json"),fetch(t).then(e=>{if(e.ok)return e.json();throw new Error("language file not found")}).then(e=>{if("object"==typeof(n=e)&&null!==n&&Object.values(n).every(P))return t=e,Object.fromEntries(Object.entries(t).map(([e,t])=>[e,j(t)]));throw new TypeError("invalid language file");var t,n});var t})).then(e=>Object.fromEntries(X.map((t,n)=>[t,new J(t).register(e[n])]))),e.MANAGER_PROMISE=e.DICTS_PROMISE.then(e=>new Q(e[n()])),e.get=n,e.set=r,e.setNext=function(){const e=X.indexOf(n()),t=X[(e+1)%X.length];return r(t),t};const o=localStorage.getItem(t);ee(o)?r(o):r(X.find(e=>{return t=e,n=navigator.language,"string"==typeof t&&(t=new Intl.Locale(t)),"string"==typeof n&&(n=new Intl.Locale(n)),(t.language!==n.language?0:t.script!==n.script?1:t.region!==n.region?2:3)>0;var t,n})??Z);const a=new T,i={"text-dict-key":(t,n)=>e.MANAGER_PROMISE.then(e=>e.registerTextContent(t,a,n)),"title-dict-key":(t,n)=>e.MANAGER_PROMISE.then(e=>e.registerTitle(t,a,n))};K.onceDOMContentLoaded().then(()=>{for(const e in i)Array.from(document.querySelectorAll(`*[${e}]`)).filter(e=>e instanceof HTMLElement).forEach(t=>{const n=t.getAttribute(e);n&&i[e](n,t)})})}(Y||(Y={}));const te=Y;function ne(e,t){return"string"==typeof e?document.createTextNode(e):e instanceof Element?e:e instanceof re?e.apply(t):null}class re{mold;defaultCtx;constructor(e,t){this.mold=e,this.defaultCtx=Object.freeze(t)}addStep(e){return new re(t=>{const{e:n,ctx:r}=this.mold(t);return e(n,r)},this.defaultCtx)}id(e){return this.addStep((t,n)=>(re.DynValue.resolve(e,t,n).then(e=>t.id=e),{e:t,ctx:n}))}class(...e){return this.addStep((t,n)=>{for(const r of e)re.DynValue.resolve(r,t,n).then(e=>{t.classList.add(...[re.DynValue.evaluate(e,t,n)].flat().filter(e=>e).map(e=>e.toString().split(/\W+/)).flat())});return{e:t,ctx:n}})}attr(e,t){return this.addStep((n,r)=>(re.DynValue.resolve(e,n,r).then(e=>{e&&(t?re.DynValue.resolve(t,n,r).then(t=>{null!=t&&n.setAttribute(e,t)}):n.toggleAttribute(e,!0))}),{e:n,ctx:r}))}attrs(e){return this.addStep((t,n)=>(re.DynValue.resolve(e,t,n).then(e=>{for(const n in e){const r=e[n];null!==r&&t.setAttribute(n,r)}}),{e:t,ctx:n}))}children(...e){return this.addStep((t,n)=>{for(const r of e){const e=re.DynValue.evaluate(r,t,n);if(e instanceof Promise){const r=document.createElement("placeholder");t.appendChild(r),e.then(e=>r.replaceWith(...[e].flat().map(e=>ne(e,n)).filter(e=>null!==e)))}else t.append(...[e].flat().map(e=>ne(e,n)).filter(e=>null!==e))}return{e:t,ctx:n}})}text(e){return this.addStep((t,n)=>(re.DynValue.resolve(e,t,n).then(e=>t.textContent=e),{e:t,ctx:n}))}phraseText(e,t=new T,n=te.MANAGER_PROMISE){return this.addStep((r,o)=>(Promise.all([n,re.DynValue.evaluate(e,r,o)]).then(([e,n])=>e.registerTextContent(n,t,r)),{e:r,ctx:o}))}tooltip(e){return this.addStep((t,n)=>(re.DynValue.resolve(e,t,n).then(e=>t.title=e),{e:t,ctx:n}))}phraseTooltip(e,t=new T,n=te.MANAGER_PROMISE){return this.addStep((r,o)=>(Promise.all([n,re.DynValue.evaluate(e,r,o)]).then(([e,n])=>e.registerTitle(n,t,r)),{e:r,ctx:o}))}on(e,t){return this.addStep((n,r)=>(n.addEventListener(e,e=>t(e,n,r)),{e:n,ctx:r}))}once(e,t){return this.addStep((n,r)=>(n.addEventListener(e,e=>t(e,n,r),{once:!0}),{e:n,ctx:r}))}do(e){return this.addStep((t,n)=>(e(t,n),{e:t,ctx:n}))}apply(e){const t=re.applyContextDefaults(this.defaultCtx,e);return this.mold(t).e}copy(){return new re(this.mold,this.defaultCtx)}static fromTagName(e,t){return new re(t=>({e:document.createElement(e),ctx:t}),t)}}!function(e){let t;e.applyContextDefaults=function(e,t){return"object"==typeof e&&null!==e?{...e,...t}:t??e},function(e){function t(e,t,n){return"function"==typeof e?e(t,n):e}e.evaluate=t,e.resolve=function(e,n,r){return Promise.resolve(t(e,n,r))}}(t=e.DynValue||(e.DynValue={}))}(re||(re={}));const oe=re,ae=new DOMParser;function ie(e,t){return fetch(`images/icons/${t}/${e}.svg`).then(e=>{if(e.ok)return e.text();throw new Error("icon SVG not found")}).then(e=>ae.parseFromString(e,"image/svg+xml")).then(t=>{const n=t.firstChild;if(n instanceof SVGElement)return n.classList.add("icon"),n.setAttribute("icon-name",e),n;throw new TypeError("invalid SVG")})}const se=oe.fromTagName("button",{text:"button",icon:"add-person",onClick:()=>{}}).children((e,t)=>{if("dictKey"in t){const e=document.createElement("h3");return te.MANAGER_PROMISE.then(n=>n.registerTextContent(t.dictKey,new T,e)),e}if("text"in t){const e=document.createElement("h3");return e.textContent=t.text,e}return null},(e,t)=>"icon"in t&&ie(t.icon,"24px")).do((e,t)=>e.addEventListener("click",n=>t.onClick(e,n))),ce=oe.fromTagName("button",{text:"button",href:"/"}).class("link-button").children((e,t)=>{if("dictKey"in t){const e=document.createElement("h3");return te.MANAGER_PROMISE.then(n=>n.registerTextContent(t.dictKey,new T,e)),e}{const e=document.createElement("h3");return e.textContent=t.text,e}},ie("open-in-new","24px")).do((e,t)=>e.addEventListener("click",()=>window.open(t.href,"_blank")?.focus()));var le;!function(e){e.DEFAULT_LIGHT="default-light",e.DEFAULT_DARK="default-dark",e.PLANT="plant",e.SARDINE="sardine",e.FILMSTRIP="filmstrip",e.HEART="heart"}(le||(le={}));const ue=[le.DEFAULT_LIGHT,le.DEFAULT_DARK,le.PLANT,le.SARDINE,le.FILMSTRIP,le.HEART],he=le.DEFAULT_LIGHT;function pe(e){return Object.values(le).some(t=>e===t)}!function(e){const t="palette";function n(){const e=localStorage.getItem(t);return pe(e)?e:he}function r(e){localStorage.setItem(t,e),K.onceDOMContentLoaded().then(()=>{document.body.setAttribute("palette",e)})}e.get=n,e.set=r,e.setNext=function(){const e=ue.indexOf(n()),t=ue[(e+1)%ue.length];return r(t),t};const o=localStorage.getItem(t);pe(o)?r(o):matchMedia("(prefers-color-scheme: light)").matches?r(e.DEFAULT_LIGHT):matchMedia("(prefers-color-scheme: dark)").matches?r(e.DEFAULT_DARK):r(he)}(le||(le={}));const de=le;var we;!function(e){e.NORMAL="normal",e.HIGH="high"}(we||(we={}));const me=[we.NORMAL,we.HIGH],fe=we.NORMAL;function ge(e){return Object.values(we).some(t=>e===t)}!function(e){const t="contrast";function n(){const e=localStorage.getItem(t);return ge(e)?e:fe}function r(e){localStorage.setItem(t,e),K.onceDOMContentLoaded().then(()=>{document.body.setAttribute("contrast",e)})}e.get=n,e.set=r,e.setNext=function(){const e=me.indexOf(n()),t=me[(e+1)%me.length];return r(t),t};const o=localStorage.getItem(t);ge(o)?r(o):matchMedia("(prefers-contrast: more)").matches?r(e.HIGH):r(fe)}(we||(we={}));const ye=we;var Ee;!function(e){e.NORMAL="normal",e.REDUCED="reduced"}(Ee||(Ee={}));const be=[Ee.NORMAL,Ee.REDUCED],Te=Ee.NORMAL;function ve(e){return Object.values(Ee).some(t=>e===t)}!function(e){const t="motion";function n(){const e=localStorage.getItem(t);return ve(e)?e:Te}function r(e){localStorage.setItem(t,e),K.onceDOMContentLoaded().then(()=>{document.body.setAttribute("motion",e)})}e.get=n,e.set=r,e.setNext=function(){const e=be.indexOf(n()),t=be[(e+1)%be.length];return r(t),t};const o=localStorage.getItem(t);ve(o)?r(o):matchMedia("(prefers-reduced-motion: reduce)").matches?r(e.REDUCED):r(Te)}(Ee||(Ee={}));const xe=Ee,Se={[de.DEFAULT_LIGHT]:"light-mode",[de.DEFAULT_DARK]:"dark-mode",[de.PLANT]:"nature",[de.SARDINE]:"set-meal",[de.FILMSTRIP]:"theaters",[de.HEART]:"heart-smile"},Me={[ye.NORMAL]:"contrast",[ye.HIGH]:"contrast-circle"},Ae={[xe.NORMAL]:"trail-length",[xe.REDUCED]:"trail-length-short"},Le={[te.ENGLISH]:"us-flag",[te.DUTCH]:"nl-flag"};Promise.all([(async()=>oe.fromTagName("header",{}).class("flex-columns").children(oe.fromTagName("h1",{}).id("logo").text("Guess Some Words"),oe.fromTagName("div",{}).id("settings-dropdown").class("flex","rows").children(ie("settings","40px"),oe.fromTagName("div",{}).class("hr"),oe.fromTagName("button",{}).id("language-button").phraseTooltip("header.settings.language").children(ie(Le[te.get()],"40px")).on("click",(e,t)=>{const n=te.setNext();ie(Le[n],"40px").then(e=>t.firstChild?.replaceWith(e))}),oe.fromTagName("button",{}).id("color-palette-button").phraseTooltip("header.settings.colorPalette").children(ie(Se[de.get()],"40px")).on("click",(e,t)=>{const n=de.setNext();ie(Se[n],"40px").then(e=>t.firstChild?.replaceWith(e))}),document.fullscreenEnabled&&oe.fromTagName("button",{}).id("fullscreen-button").phraseTooltip("header.settings.fullscreen").children(ie("fullscreen","40px")).on("click",(e,t)=>{document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen({navigationUI:"hide"})}).do(e=>document.addEventListener("fullscreenchange",()=>{ie(document.fullscreenElement?"fullscreen-exit":"fullscreen","40px").then(t=>e.firstElementChild?.replaceWith(t))})),oe.fromTagName("button",{}).id("high-contrast-button").phraseTooltip("header.settings.contrast").children(ie(Me[ye.get()],"40px")).on("click",(e,t)=>{const n=ye.setNext();ie(Me[n],"40px").then(e=>t.firstChild?.replaceWith(e))}),oe.fromTagName("button",{}).id("reduced-motion-button").phraseTooltip("header.settings.reducedMotion").children(ie(Ae[xe.get()],"40px")).on("click",(e,t)=>{const n=xe.setNext();ie(Ae[n],"40px").then(e=>t.firstChild?.replaceWith(e))})).on("mouseenter",(e,t)=>{z.getViewport()>z.Viewport.TABLET&&z.canHover()&&(t.toggleAttribute("open",!0),t.style.setProperty("--target-height",`${t.scrollHeight}px`))}).on("mouseleave",(e,t)=>{z.getViewport()>z.Viewport.TABLET&&z.canHover()&&t.toggleAttribute("open",!1)}).on("click",(e,t)=>{(z.getViewport()<=z.Viewport.TABLET||!z.canHover())&&(t.toggleAttribute("open"),t.style.setProperty("--target-height",`${t.scrollHeight}px`))}).do(e=>new MutationObserver(()=>e.style.setProperty("--target-height",`${e.scrollHeight}px`)).observe(e,{childList:!0,subtree:!0}))).apply())(),(async()=>oe.fromTagName("footer",{}).class("flex","columns").children(oe.fromTagName("p",{}).phraseText("footer.madeBy"),oe.fromTagName("a",{}).text("THSlimes").attr("href","https://github.com/THSlimes").attr("target","_blank")).apply())(),K.onceDOMContentLoaded()]).then(([e,t])=>{document.body.prepend(e),document.body.append(t)});let Ne=[];K.onceDOMContentLoaded().then(()=>{Ne.push(F.replaceWith("classic-mode-button",se.apply({dictKey:"index.presets.classic",icon:"play-circle",onClick:()=>(Ne.forEach(e=>e.disabled=!0),fetch("./game-modes/classic.json").then(e=>e.json()).then(e=>{if(console.log(e),B.is(e))return e;throw new TypeError("invalid serialized game mode")}).catch(e=>{throw Ne.forEach(e=>e.disabled=!1),e}).then(e=>{sessionStorage.setItem(t.GAME_MODE_SESSION_STORAGE_KEY,JSON.stringify(e)),location.assign("./play.html")}))})),F.replaceWith("speedrun-mode-button",se.apply({dictKey:"index.presets.speedrun",icon:"speed"})),F.replaceWith("endless-mode-button",se.apply({dictKey:"index.presets.endless",icon:"all-inclusive"})),F.replaceWith("upload-game-mode-button",se.apply({dictKey:"index.custom.upload",icon:"upload"}))),F.replaceWith("docs-button",ce.apply({dictKey:"index.presets.docs",href:"https://github.com/THSlimes/guess-some-words"}))})})();